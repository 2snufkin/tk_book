<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Libraries/Apache Poi" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Apache Poi | TkBook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://2snufkin.github.io/tk_book/img/favicon.png"><meta data-rh="true" name="twitter:image" content="https://2snufkin.github.io/tk_book/img/favicon.png"><meta data-rh="true" property="og:url" content="https://2snufkin.github.io/tk_book/docs/Libraries/Apache Poi"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Apache Poi | TkBook"><meta data-rh="true" name="description" content="Apache POI User Guide Manual"><meta data-rh="true" property="og:description" content="Apache POI User Guide Manual"><link data-rh="true" rel="icon" href="/tk_book/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://2snufkin.github.io/tk_book/docs/Libraries/Apache Poi"><link data-rh="true" rel="alternate" href="https://2snufkin.github.io/tk_book/docs/Libraries/Apache Poi" hreflang="en"><link data-rh="true" rel="alternate" href="https://2snufkin.github.io/tk_book/docs/Libraries/Apache Poi" hreflang="x-default"><link rel="stylesheet" href="/tk_book/assets/css/styles.5aa24b33.css">
<script src="/tk_book/assets/js/runtime~main.a1033f41.js" defer="defer"></script>
<script src="/tk_book/assets/js/main.1b183786.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/tk_book/docs/"><div class="navbar__logo"><img src="/tk_book/img/favicon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/tk_book/img/favicon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TK Book</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tk_book/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/Best Practice/Best Practices In Java Development">Best Practice</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/Errors/Cannotcreatetransaction">Errors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/Java &amp; Spring/Comparing Objects">Java &amp; Spring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/tk_book/docs/Libraries/Apache Poi - Preformence">Libraries</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tk_book/docs/Libraries/Apache Poi - Preformence">Considerations for Using Apache Commons ByteArrayOutputStream vs java.io.ByteArrayOutputStream and SXSSFWorkbook vs XSSFWorkbook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tk_book/docs/Libraries/Apache Poi">Apache Poi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tk_book/docs/Libraries/Liquibase">Liquibase</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/Security/Sescurity Audit">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/Tumorotek/Busniess Logic/User Rights">Tumorotek</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tk_book/docs/ZK/Annotations">ZK</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Libraries</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Apache Poi</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Apache Poi</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="apache-poi-user-guide-manual">Apache POI User Guide Manual<a href="#apache-poi-user-guide-manual" class="hash-link" aria-label="Direct link to Apache POI User Guide Manual" title="Direct link to Apache POI User Guide Manual">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-new-workbook">1. New Workbook<a href="#1-new-workbook" class="hash-link" aria-label="Direct link to 1. New Workbook" title="Direct link to 1. New Workbook">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-workbooks">Creating Workbooks<a href="#creating-workbooks" class="hash-link" aria-label="Direct link to Creating Workbooks" title="Direct link to Creating Workbooks">​</a></h4>
<p>To create a new workbook, use either <code>HSSFWorkbook</code> for <code>.xls</code> format or <code>XSSFWorkbook</code> for <code>.xlsx</code> format.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook(); // or new XSSFWorkbook();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="saving-workbooks">Saving Workbooks<a href="#saving-workbooks" class="hash-link" aria-label="Direct link to Saving Workbooks" title="Direct link to Saving Workbooks">​</a></h4>
<p>Save the workbook to a file using <code>wb.write(fileOut)</code> where <code>fileOut</code> is an <code>OutputStream</code>.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-new-sheet">2. New Sheet<a href="#2-new-sheet" class="hash-link" aria-label="Direct link to 2. New Sheet" title="Direct link to 2. New Sheet">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-sheets">Creating Sheets<a href="#creating-sheets" class="hash-link" aria-label="Direct link to Creating Sheets" title="Direct link to Creating Sheets">​</a></h4>
<p>To create a new sheet in a workbook:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet1 = wb.createSheet(&quot;new sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet2 = wb.createSheet(&quot;second sheet&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ensure sheet names are valid (max 31 characters, specific character restrictions). Use <code>WorkbookUtil.createSafeSheetName(nameProposal)</code> to create valid names.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-creating-cells">3. Creating Cells<a href="#3-creating-cells" class="hash-link" aria-label="Direct link to 3. Creating Cells" title="Direct link to 3. Creating Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-cells">Working with Cells<a href="#working-with-cells" class="hash-link" aria-label="Direct link to Working with Cells" title="Direct link to Working with Cells">​</a></h4>
<p>To create cells and set their values:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Row row = sheet.createRow(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell1 = row.createCell(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell1.setCellValue(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(1).setCellValue(1.2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell3 = row.createCell(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell3.setCellValue(&quot;This is a string&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell4 = row.createCell(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell4.setCellValue(true);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-creating-date-cells">4. Creating Date Cells<a href="#4-creating-date-cells" class="hash-link" aria-label="Direct link to 4. Creating Date Cells" title="Direct link to 4. Creating Date Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-date-values">Handling Date Values<a href="#handling-date-values" class="hash-link" aria-label="Direct link to Handling Date Values" title="Direct link to Handling Date Values">​</a></h4>
<p>To work with date values:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell1 = row.createCell(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell1.setCellValue(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CreationHelper createHelper = wb.getCreationHelper();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle cellStyle = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cellStyle.setDataFormat(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    createHelper.createDataFormat().getFormat(&quot;m/d/yy h:mm&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell2 = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell2.setCellValue(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell2.setCellStyle(cellStyle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell3 = row.createCell(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell3.setCellValue(Calendar.getInstance());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell3.setCellStyle(cellStyle);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-working-with-different-types-of-cells">5. Working with Different Types of Cells<a href="#5-working-with-different-types-of-cells" class="hash-link" aria-label="Direct link to 5. Working with Different Types of Cells" title="Direct link to 5. Working with Different Types of Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-different-types">Handling Different Types<a href="#handling-different-types" class="hash-link" aria-label="Direct link to Handling Different Types" title="Direct link to Handling Different Types">​</a></h4>
<p>Cells can contain various types of data:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(0).setCellValue(1.1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(1).setCellValue(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(2).setCellValue(Calendar.getInstance());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(3).setCellValue(&quot;a string&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(4).setCellValue(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.createCell(5).setCellType(CellType.ERROR);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-demonstrating-alignment-options">6. Demonstrating Alignment Options<a href="#6-demonstrating-alignment-options" class="hash-link" aria-label="Direct link to 6. Demonstrating Alignment Options" title="Direct link to 6. Demonstrating Alignment Options">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cell-alignment">Cell Alignment<a href="#cell-alignment" class="hash-link" aria-label="Direct link to Cell Alignment" title="Direct link to Cell Alignment">​</a></h4>
<p>Adjust cell alignment using <code>setAlignment</code> and <code>setVerticalAlignment</code>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">row.setHeightInPoints(30);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">createCell(wb, row, 0, HorizontalAlignment.CENTER, VerticalAlignment.BOTTOM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">createCell(wb, row, 1, HorizontalAlignment.CENTER_SELECTION, VerticalAlignment.BOTTOM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add more cells with different alignments</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-working-with-borders">7. Working with Borders<a href="#7-working-with-borders" class="hash-link" aria-label="Direct link to 7. Working with Borders" title="Direct link to 7. Working with Borders">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-borders">Adding Borders<a href="#adding-borders" class="hash-link" aria-label="Direct link to Adding Borders" title="Direct link to Adding Borders">​</a></h4>
<p>Style cells with borders:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle style = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setBorderBottom(BorderStyle.THIN);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setBottomBorderColor(IndexedColors.BLACK.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setBorderLeft(BorderStyle.THIN);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setLeftBorderColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add more border styles as needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(4);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellStyle(style);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-iterating-over-rows-and-cells">8. Iterating over Rows and Cells<a href="#8-iterating-over-rows-and-cells" class="hash-link" aria-label="Direct link to 8. Iterating over Rows and Cells" title="Direct link to 8. Iterating over Rows and Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="iterating-through-data">Iterating through Data<a href="#iterating-through-data" class="hash-link" aria-label="Direct link to Iterating through Data" title="Direct link to Iterating through Data">​</a></h4>
<p>Iterate over rows and cells in a sheet:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for (Sheet sheet : wb) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Row row : sheet) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (Cell cell : row) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Process each cell here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-merging-cells">9. Merging Cells<a href="#9-merging-cells" class="hash-link" aria-label="Direct link to 9. Merging Cells" title="Direct link to 9. Merging Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cell-merging">Cell Merging<a href="#cell-merging" class="hash-link" aria-label="Direct link to Cell Merging" title="Direct link to Cell Merging">​</a></h4>
<p>Merge cells using <code>sheet.addMergedRegion(CellRangeAddress)</code>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(&quot;This is a test of merging&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.addMergedRegion(new CellRangeAddress(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        1, // first row (0-based)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        1, // last row  (0-based)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        1, // first column (0-based)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        2  // last column  (0-based)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-working-with-fonts">10. Working with Fonts<a href="#10-working-with-fonts" class="hash-link" aria-label="Direct link to 10. Working with Fonts" title="Direct link to 10. Working with Fonts">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-fonts">Customizing Fonts<a href="#customizing-fonts" class="hash-link" aria-label="Direct link to Customizing Fonts" title="Direct link to Customizing Fonts">​</a></h4>
<p>Customize cell fonts:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Font font = wb.createFont();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">font.setFontHeightInPoints((short)24);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">font.setFontName(&quot;Courier New&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">font.setItalic(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">font.setStrikeout(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle style = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setFont(font);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(&quot;This is a test of fonts&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellStyle(style);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<p>Here is the continuation of the Apache POI user guide manual based on additional functionalities like using newlines in cells, data formats, fitting sheets to one page, setting print areas, headers and footers, and other advanced features.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-using-newlines-in-cells">11. Using Newlines in Cells<a href="#11-using-newlines-in-cells" class="hash-link" aria-label="Direct link to 11. Using Newlines in Cells" title="Direct link to 11. Using Newlines in Cells">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-newlines">Creating Newlines<a href="#creating-newlines" class="hash-link" aria-label="Direct link to Creating Newlines" title="Direct link to Creating Newlines">​</a></h4>
<p>To insert newlines in a cell and enable word wrap:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new XSSFWorkbook(); // or new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row = sheet.createRow(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(&quot;Use \n with word wrap on to create a new line&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle cs = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cs.setWrapText(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellStyle(cs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.setHeightInPoints((2 * sheet.getDefaultRowHeightInPoints()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.autoSizeColumn(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;ooxml-newlines.xlsx&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-data-formats">12. Data Formats<a href="#12-data-formats" class="hash-link" aria-label="Direct link to 12. Data Formats" title="Direct link to 12. Data Formats">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="formatting-data">Formatting Data<a href="#formatting-data" class="hash-link" aria-label="Direct link to Formatting Data" title="Direct link to Formatting Data">​</a></h4>
<p>Apply specific data formats to cells:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;format sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataFormat format = wb.createDataFormat();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row1 = sheet.createRow(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell1 = row1.createCell(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell1.setCellValue(11111.25);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle style1 = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style1.setDataFormat(format.getFormat(&quot;0.0&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell1.setCellStyle(style1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row2 = sheet.createRow(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell2 = row2.createCell(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell2.setCellValue(11111.25);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle style2 = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style2.setDataFormat(format.getFormat(&quot;#,##0.0000&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell2.setCellStyle(style2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-fit-sheet-to-one-page">13. Fit Sheet to One Page<a href="#13-fit-sheet-to-one-page" class="hash-link" aria-label="Direct link to 13. Fit Sheet to One Page" title="Direct link to 13. Fit Sheet to One Page">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adjusting-sheet-for-printing">Adjusting Sheet for Printing<a href="#adjusting-sheet-for-printing" class="hash-link" aria-label="Direct link to Adjusting Sheet for Printing" title="Direct link to Adjusting Sheet for Printing">​</a></h4>
<p>Fit sheet content to one page:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;format sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrintSetup ps = sheet.getPrintSetup();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.setAutobreaks(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ps.setFitHeight((short) 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ps.setFitWidth((short) 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create cells and rows for spreadsheet content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-set-print-area">14. Set Print Area<a href="#14-set-print-area" class="hash-link" aria-label="Direct link to 14. Set Print Area" title="Direct link to 14. Set Print Area">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="defining-print-area">Defining Print Area<a href="#defining-print-area" class="hash-link" aria-label="Direct link to Defining Print Area" title="Direct link to Defining Print Area">​</a></h4>
<p>Set a specific print area for a sheet:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;Sheet1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Option 1: Set print area by cell references</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.setPrintArea(0, &quot;$A$1:$C$2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Option 2: Set print area by indices</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.setPrintArea(0, 0, 1, 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-set-page-numbers-on-footer">15. Set Page Numbers on Footer<a href="#15-set-page-numbers-on-footer" class="hash-link" aria-label="Direct link to 15. Set Page Numbers on Footer" title="Direct link to 15. Set Page Numbers on Footer">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-page-numbers">Adding Page Numbers<a href="#adding-page-numbers" class="hash-link" aria-label="Direct link to Adding Page Numbers" title="Direct link to Adding Page Numbers">​</a></h4>
<p>Include page numbers in the footer:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook(); // or new XSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;format sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Footer footer = sheet.getFooter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">footer.setRight(&quot;Page &quot; + HeaderFooter.page() + &quot; of &quot; + HeaderFooter.numPages());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create cells and rows for spreadsheet content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="16-using-the-convenience-functions">16. Using the Convenience Functions<a href="#16-using-the-convenience-functions" class="hash-link" aria-label="Direct link to 16. Using the Convenience Functions" title="Direct link to 16. Using the Convenience Functions">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="simplified-styling-and-formatting">Simplified Styling and Formatting<a href="#simplified-styling-and-formatting" class="hash-link" aria-label="Direct link to Simplified Styling and Formatting" title="Direct link to Simplified Styling and Formatting">​</a></h4>
<p>Utilize convenience functions for styling and formatting:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook(); // or new XSSFWorkbook()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet1 = wb.createSheet(&quot;new sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create a merged region</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row = sheet1.createRow(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(&quot;This is a test of merging&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellRangeAddress region = CellRangeAddress.valueOf(&quot;B2:E5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.addMergedRegion(region);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Set borders around merged region</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setBorderBottom(BorderStyle.MEDIUM_DASHED, region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setBorderTop(BorderStyle.MEDIUM_DASHED, region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setBorderLeft(BorderStyle.MEDIUM_DASHED, region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setBorderRight(BorderStyle.MEDIUM_DASHED, region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setBottomBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setTopBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setLeftBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RegionUtil.setRightBorderColor(IndexedColors.AQUA.getIndex(), region, sheet1, wb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Set cell alignment and create cell with specific style</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellStyle style = wb.createCellStyle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style.setIndention((short) 4);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellUtil.createCell(row, 8, &quot;This is the value of the cell&quot;, style);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Write out the workbook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="17-shift-rows-up-or-down-on-a-sheet">17. Shift Rows up or down on a Sheet<a href="#17-shift-rows-up-or-down-on-a-sheet" class="hash-link" aria-label="Direct link to 17. Shift Rows up or down on a Sheet" title="Direct link to 17. Shift Rows up or down on a Sheet">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adjusting-row-positions">Adjusting Row Positions<a href="#adjusting-row-positions" class="hash-link" aria-label="Direct link to Adjusting Row Positions" title="Direct link to Adjusting Row Positions">​</a></h4>
<p>Shift rows on a sheet:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;row sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Shift rows 6 - 10 up by 5 rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.shiftRows(5, 10, -5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="18-set-a-sheet-as-selected">18. Set a Sheet as Selected<a href="#18-set-a-sheet-as-selected" class="hash-link" aria-label="Direct link to 18. Set a Sheet as Selected" title="Direct link to 18. Set a Sheet as Selected">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="marking-a-sheet-as-selected">Marking a Sheet as Selected<a href="#marking-a-sheet-as-selected" class="hash-link" aria-label="Direct link to Marking a Sheet as Selected" title="Direct link to Marking a Sheet as Selected">​</a></h4>
<p>Set a sheet as selected:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;row sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.setSelected(true);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="19-set-the-zoom-magnification">19. Set the Zoom Magnification<a href="#19-set-the-zoom-magnification" class="hash-link" aria-label="Direct link to 19. Set the Zoom Magnification" title="Direct link to 19. Set the Zoom Magnification">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adjusting-sheet-zoom">Adjusting Sheet Zoom<a href="#adjusting-sheet-zoom" class="hash-link" aria-label="Direct link to Adjusting Sheet Zoom" title="Direct link to Adjusting Sheet Zoom">​</a></h4>
<p>Set the zoom level (e.g., 75%):</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet1 = wb.createSheet(&quot;new sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.setZoom(75); // 75 percent magnification</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="20-headers-and-footers">20. Headers and Footers<a href="#20-headers-and-footers" class="hash-link" aria-label="Direct link to 20. Headers and Footers" title="Direct link to 20. Headers and Footers">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-headers-and-footers">Adding Headers and Footers<a href="#adding-headers-and-footers" class="hash-link" aria-label="Direct link to Adding Headers and Footers" title="Direct link to Adding Headers and Footers">​</a></h4>
<p>Set headers and footers for a sheet:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(&quot;new sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Header header = sheet.getHeader();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">header.setCenter(&quot;Center Header&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">header.setLeft(&quot;Left Header&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">header.setRight(&quot;Right Header&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-outlining">21. Outlining<a href="#21-outlining" class="hash-link" aria-label="Direct link to 21. Outlining" title="Direct link to 21. Outlining">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="grouping-and-outlining">Grouping and Outlining<a href="#grouping-and-outlining" class="hash-link" aria-label="Direct link to Grouping and Outlining" title="Direct link to Grouping and Outlining">​</a></h4>
<p>Group rows and columns to create outlines:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet1 = wb.createSheet(&quot;new sheet&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupRow(5, 14);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupRow(7, 14);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupRow(16, 19);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupColumn(4, 7);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupColumn(9, 12);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet1.groupColumn(10, 11);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (OutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wb.write(fileOut);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wb.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-creating-named-range--named-cell">22. Creating Named Range / Named Cell<a href="#22-creating-named-range--named-cell" class="hash-link" aria-label="Direct link to 22. Creating Named Range / Named Cell" title="Direct link to 22. Creating Named Range / Named Cell">​</a></h2>
<p>Named Range is a way to refer to a group of cells by a name. Named Cell refers to a single cell. You can create and refer to cells in a workbook by their named range. When working with Named Ranges, the classes <code>org.apache.poi.ss.util.CellReference</code> and <code>org.apache.poi.ss.util.AreaReference</code> are used.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-named-range-for-a-single-cell-using-areareference">create named range for a single cell using AreaReference<a href="#create-named-range-for-a-single-cell-using-areareference" class="hash-link" aria-label="Direct link to create named range for a single cell using AreaReference" title="Direct link to create named range for a single cell using AreaReference">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// setup code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String sname = &quot;TestSheet&quot;, cname = &quot;TestName&quot;, cvalue = &quot;TestVal&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new HSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = wb.createSheet(sname);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.createRow(0).createCell(0).setCellValue(cvalue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name namedCell = wb.createName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCell.setNameName(cname + &quot;1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String reference = sname + &quot;!$A$1:$A$1&quot;; // area reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCell.setRefersToFormula(reference);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-named-range-for-a-single-cell-using-cellreference">create named range for a single cell using CellReference<a href="#create-named-range-for-a-single-cell-using-cellreference" class="hash-link" aria-label="Direct link to create named range for a single cell using CellReference" title="Direct link to create named range for a single cell using CellReference">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name namedCel2 = wb.createName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel2.setNameName(cname + &quot;2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reference = sname + &quot;!$A$1&quot;; // cell reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel2.setRefersToFormula(reference);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-named-range-for-an-area-using-areareference">create named range for an area using AreaReference<a href="#create-named-range-for-an-area-using-areareference" class="hash-link" aria-label="Direct link to create named range for an area using AreaReference" title="Direct link to create named range for an area using AreaReference">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name namedCel3 = wb.createName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel3.setNameName(cname + &quot;3&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reference = sname + &quot;!$A$1:$C$5&quot;; // area reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel3.setRefersToFormula(reference);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-named-formula">create named formula<a href="#create-named-formula" class="hash-link" aria-label="Direct link to create named formula" title="Direct link to create named formula">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name namedCel4 = wb.createName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel4.setNameName(&quot;my_sum&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namedCel4.setRefersToFormula(&quot;SUM(&quot; + sname + &quot;!$I$2:$I$6)&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="23-reading-from-named-range--named-cell">23. Reading from Named Range / Named Cell<a href="#23-reading-from-named-range--named-cell" class="hash-link" aria-label="Direct link to 23. Reading from Named Range / Named Cell" title="Direct link to 23. Reading from Named Range / Named Cell">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// setup code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String cname = &quot;TestName&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = getMyWorkbook(); // retrieve workbook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int namedCellIdx = wb.getNameIndex(cellName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name aNamedCell = wb.getNameAt(namedCellIdx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AreaReference aref = new AreaReference(aNamedCell.getRefersToFormula());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellReference[] crefs = aref.getAllReferencedCells();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (int i=0; i&lt;crefs.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sheet s = wb.getSheet(crefs[i].getSheetName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Row r = sheet.getRow(crefs[i].getRow());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cell c = r.getCell(crefs[i].getCol());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // extract the cell contents based on cell type etc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reading-from-non-contiguous-named-ranges">Reading from non-contiguous Named Ranges<a href="#reading-from-non-contiguous-named-ranges" class="hash-link" aria-label="Direct link to Reading from non-contiguous Named Ranges" title="Direct link to Reading from non-contiguous Named Ranges">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Setup code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String cname = &quot;TestName&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = getMyWorkbook(); // retrieve workbook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int namedCellIdx = wb.getNameIndex(cellName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name aNamedCell = wb.getNameAt(namedCellIdx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AreaReference[] arefs = AreaReference.generateContiguous(aNamedCell.getRefersToFormula());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (int i=0; i&lt;arefs.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CellReference[] crefs = arefs[i].getCells();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int j=0; j&lt;crefs.length; j++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sheet s = wb.getSheet(crefs[j].getSheetName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Row r = s.getRow(crefs[j].getRow());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cell c = r.getCell(crefs[j].getCol());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Do something with this corner cell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When a cell is deleted, Excel does not delete the attached named range. Therefore, the workbook can contain named ranges that point to cells that no longer exist. Check the validity of a reference before constructing <code>AreaReference</code>.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if(name.isDeleted()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // named range points to a deleted cell.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AreaReference ref = new AreaReference(name.getRefersToFormula());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="24-adjust-column-width-to-fit-the-contents">24. Adjust column width to fit the contents<a href="#24-adjust-column-width-to-fit-the-contents" class="hash-link" aria-label="Direct link to 24. Adjust column width to fit the contents" title="Direct link to 24. Adjust column width to fit the contents">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = workbook.getSheetAt(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.autoSizeColumn(0); // adjust width of the first column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.autoSizeColumn(1); // adjust width of the second column</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For <code>SXSSFWorkbooks</code>, ensure columns are tracked for auto-sizing prior to flushing rows.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SXSSFWorkbook workbook = new SXSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SXSSFSheet sheet = workbook.createSheet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.trackColumnForAutoSizing(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.trackColumnForAutoSizing(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// create cells</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (int r=0; r &lt; 10; r++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Row row = sheet.createRow(r);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int c; c &lt; 10; c++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cell cell = row.createCell(c);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cell.setCellValue(&quot;Cell &quot; + c.getAddress().formatAsString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.autoSizeColumn(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheet.autoSizeColumn(1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note:</strong> <code>Sheet#autoSizeColumn()</code> does not evaluate formula cells; their width is based on the cached formula result.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="25-conditional-formatting">25. Conditional Formatting<a href="#25-conditional-formatting" class="hash-link" aria-label="Direct link to 25. Conditional Formatting" title="Direct link to 25. Conditional Formatting">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook workbook = new HSSFWorkbook(); // or new XSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = workbook.createSheet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SheetConditionalFormatting sheetCF = sheet.getSheetConditionalFormatting();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConditionalFormattingRule rule1 = sheetCF.createConditionalFormattingRule(ComparisonOperator.EQUAL, &quot;0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FontFormatting fontFmt = rule1.createFontFormatting();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fontFmt.setFontStyle(true, false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fontFmt.setFontColorIndex(IndexedColors.DARK_RED.index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BorderFormatting bordFmt = rule1.createBorderFormatting();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bordFmt.setBorderBottom(BorderStyle.THIN);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bordFmt.setBorderTop(BorderStyle.THICK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bordFmt.setBorderLeft(BorderStyle.DASHED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bordFmt.setBorderRight(BorderStyle.DOTTED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PatternFormatting patternFmt = rule1.createPatternFormatting();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">patternFmt.setFillBackgroundColor(IndexedColors.YELLOW.index);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConditionalFormattingRule rule2 = sheetCF.createConditionalFormattingRule(ComparisonOperator.BETWEEN, &quot;-10&quot;, &quot;10&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConditionalFormattingRule [] cfRules = { rule1, rule2 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellRangeAddress[] regions = { CellRangeAddress.valueOf(&quot;A3:A5&quot;) };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sheetCF.addConditionalFormatting(regions, cfRules);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="26-hiding-and-un-hiding-rows">26. Hiding and Un-Hiding Rows<a href="#26-hiding-and-un-hiding-rows" class="hash-link" aria-label="Direct link to 26. Hiding and Un-Hiding Rows" title="Direct link to 26. Hiding and Un-Hiding Rows">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook workbook = new XSSFWorkbook();  // OR new HSSFWorkbook()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = workbook.createSheet(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row = workbook.createRow(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row.setZeroHeight();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To unhide previously hidden rows:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook workbook = WorkbookFactory.create(new File(.......));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = workbook.getSheetAt(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Iterator&lt;Row&gt; rowIter = sheet.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while(rowIter.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Row row = rowIter.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(row.getZeroHeight()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        row.setZeroHeight(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="27setting-cell-properties">27.Setting Cell Properties<a href="#27setting-cell-properties" class="hash-link" aria-label="Direct link to 27.Setting Cell Properties" title="Direct link to 27.Setting Cell Properties">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workbook workbook = new XSSFWorkbook();  // OR new HSSFWorkbook()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sheet = workbook.createSheet(&quot;Sheet1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// border around a cell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.BORDER_TOP, BorderStyle.MEDIUM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.BORDER_BOTTOM, BorderStyle.MEDIUM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.BORDER_LEFT, BorderStyle.MEDIUM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.BORDER_RIGHT, BorderStyle.MEDIUM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Give it a color (RED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.TOP_BORDER_COLOR, IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.BOTTOM_BORDER_COLOR, IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.LEFT_BORDER_COLOR, IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">properties.put(CellUtil.RIGHT_BORDER_COLOR, IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Apply the borders to the cell at B2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Row row = sheet.createRow(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CellUtil.setCellStyleProperties(cell, properties);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Apply the borders to a 3x3 region starting at D4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (int ix=3; ix &lt;= 5; ix++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  row = sheet.createRow(ix);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (int iy = 3; iy &lt;= 5; iy++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cell = row.createCell(iy);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CellUtil.setCellStyleProperties(cell, properties);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="28drawing-borders">28.Drawing Borders<a href="#28drawing-borders" class="hash-link" aria-label="Direct link to 28.Drawing Borders" title="Direct link to 28.Drawing Borders">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PropertyTemplate pt = new PropertyTemplate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// #1) these borders will all be medium in default color</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(1, 3, 1, 3), BorderStyle.MEDIUM, BorderExtent.ALL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// #2) these cells will have medium outside borders and thin inside borders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3), BorderStyle.MEDIUM, BorderExtent.OUTSIDE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(5, 7, 1, 3), BorderStyle.THIN, BorderExtent.INSIDE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// #3) these cells will all be medium weight with different colors for the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     outside, inside horizontal, and inside vertical borders. The center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     cell will have no borders.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3), BorderStyle.MEDIUM, IndexedColors.RED.getIndex(), BorderExtent.OUTSIDE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3), BorderStyle.MEDIUM, IndexedColors.BLUE.getIndex(), BorderExtent.INSIDE_VERTICAL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(9, 11, 1, 3), BorderStyle.MEDIUM, IndexedColors.GREEN.getIndex(), BorderExtent.INSIDE_HORIZONTAL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.drawBorders(new CellRangeAddress(10, 10, 2, 2), BorderStyle.NONE, BorderExtent.ALL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// apply borders to sheet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Workbook wb = new XSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sheet sh = wb.createSheet(&quot;Sheet1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pt.applyBorders(sh);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="29creating-a-pivot-table">29.Creating a Pivot Table<a href="#29creating-a-pivot-table" class="hash-link" aria-label="Direct link to 29.Creating a Pivot Table" title="Direct link to 29.Creating a Pivot Table">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">XSSFWorkbook wb = new XSSFWorkbook();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XSS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FSheet sheet = wb.createSheet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create some data to build the pivot table on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setCellData(sheet);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XSSFPivotTable pivotTable = sheet.createPivotTable(new AreaReference(&quot;A1:D4&quot;), new CellReference(&quot;H5&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Configure the pivot table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use first column as row label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pivotTable.addRowLabel(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Sum up the second column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pivotTable.addColumnLabel(DataConsolidateFunction.SUM, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Set the third column as filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pivotTable.addColumnLabel(DataConsolidateFunction.AVERAGE, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add filter on fourth column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pivotTable.addReportFilter(3);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="29--cells-with-multiple-styles-rich-text-strings">29.  Cells with multiple styles (Rich Text Strings)<a href="#29--cells-with-multiple-styles-rich-text-strings" class="hash-link" aria-label="Direct link to 29.  Cells with multiple styles (Rich Text Strings)" title="Direct link to 29.  Cells with multiple styles (Rich Text Strings)">​</a></h2>
<p>To apply different formatting to different parts of a cell, use <code>RichTextString</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hssf-example">HSSF Example<a href="#hssf-example" class="hash-link" aria-label="Direct link to HSSF Example" title="Direct link to HSSF Example">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HSSFCell hssfCell = row.createCell(idx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HSSFRichTextString richString = new HSSFRichTextString(&quot;Hello, World!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">richString.applyFont(0, 6, font1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">richString.applyFont(6, 13, font2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hssfCell.setCellValue(richString);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xssf-example">XSSF Example<a href="#xssf-example" class="hash-link" aria-label="Direct link to XSSF Example" title="Direct link to XSSF Example">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">XSSFCell cell = row.createCell(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XSSFRichTextString rt = new XSSFRichTextString(&quot;The quick brown fox&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rt.applyFont(0, 10, font1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rt.applyFont(10, 19, font2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rt.append(&quot; Jumped over the lazy dog&quot;, font3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cell.setCellValue(rt);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/tk_book/docs/Libraries/Apache Poi - Preformence"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Considerations for Using Apache Commons ByteArrayOutputStream vs java.io.ByteArrayOutputStream and SXSSFWorkbook vs XSSFWorkbook</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tk_book/docs/Libraries/Liquibase"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Liquibase</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#apache-poi-user-guide-manual" class="table-of-contents__link toc-highlight">Apache POI User Guide Manual</a><ul><li><a href="#1-new-workbook" class="table-of-contents__link toc-highlight">1. New Workbook</a></li><li><a href="#2-new-sheet" class="table-of-contents__link toc-highlight">2. New Sheet</a></li><li><a href="#3-creating-cells" class="table-of-contents__link toc-highlight">3. Creating Cells</a></li><li><a href="#4-creating-date-cells" class="table-of-contents__link toc-highlight">4. Creating Date Cells</a></li><li><a href="#5-working-with-different-types-of-cells" class="table-of-contents__link toc-highlight">5. Working with Different Types of Cells</a></li><li><a href="#6-demonstrating-alignment-options" class="table-of-contents__link toc-highlight">6. Demonstrating Alignment Options</a></li><li><a href="#7-working-with-borders" class="table-of-contents__link toc-highlight">7. Working with Borders</a></li><li><a href="#8-iterating-over-rows-and-cells" class="table-of-contents__link toc-highlight">8. Iterating over Rows and Cells</a></li><li><a href="#9-merging-cells" class="table-of-contents__link toc-highlight">9. Merging Cells</a></li><li><a href="#10-working-with-fonts" class="table-of-contents__link toc-highlight">10. Working with Fonts</a></li><li><a href="#11-using-newlines-in-cells" class="table-of-contents__link toc-highlight">11. Using Newlines in Cells</a></li><li><a href="#12-data-formats" class="table-of-contents__link toc-highlight">12. Data Formats</a></li><li><a href="#13-fit-sheet-to-one-page" class="table-of-contents__link toc-highlight">13. Fit Sheet to One Page</a></li><li><a href="#14-set-print-area" class="table-of-contents__link toc-highlight">14. Set Print Area</a></li><li><a href="#15-set-page-numbers-on-footer" class="table-of-contents__link toc-highlight">15. Set Page Numbers on Footer</a></li><li><a href="#16-using-the-convenience-functions" class="table-of-contents__link toc-highlight">16. Using the Convenience Functions</a></li><li><a href="#17-shift-rows-up-or-down-on-a-sheet" class="table-of-contents__link toc-highlight">17. Shift Rows up or down on a Sheet</a></li><li><a href="#18-set-a-sheet-as-selected" class="table-of-contents__link toc-highlight">18. Set a Sheet as Selected</a></li><li><a href="#19-set-the-zoom-magnification" class="table-of-contents__link toc-highlight">19. Set the Zoom Magnification</a></li><li><a href="#20-headers-and-footers" class="table-of-contents__link toc-highlight">20. Headers and Footers</a></li><li><a href="#21-outlining" class="table-of-contents__link toc-highlight">21. Outlining</a></li></ul></li><li><a href="#22-creating-named-range--named-cell" class="table-of-contents__link toc-highlight">22. Creating Named Range / Named Cell</a><ul><li><a href="#create-named-range-for-a-single-cell-using-areareference" class="table-of-contents__link toc-highlight">create named range for a single cell using AreaReference</a></li><li><a href="#create-named-range-for-a-single-cell-using-cellreference" class="table-of-contents__link toc-highlight">create named range for a single cell using CellReference</a></li><li><a href="#create-named-range-for-an-area-using-areareference" class="table-of-contents__link toc-highlight">create named range for an area using AreaReference</a></li><li><a href="#create-named-formula" class="table-of-contents__link toc-highlight">create named formula</a></li></ul></li><li><a href="#23-reading-from-named-range--named-cell" class="table-of-contents__link toc-highlight">23. Reading from Named Range / Named Cell</a><ul><li><a href="#reading-from-non-contiguous-named-ranges" class="table-of-contents__link toc-highlight">Reading from non-contiguous Named Ranges</a></li></ul></li><li><a href="#24-adjust-column-width-to-fit-the-contents" class="table-of-contents__link toc-highlight">24. Adjust column width to fit the contents</a></li><li><a href="#25-conditional-formatting" class="table-of-contents__link toc-highlight">25. Conditional Formatting</a></li><li><a href="#26-hiding-and-un-hiding-rows" class="table-of-contents__link toc-highlight">26. Hiding and Un-Hiding Rows</a></li><li><a href="#27setting-cell-properties" class="table-of-contents__link toc-highlight">27.Setting Cell Properties</a></li><li><a href="#28drawing-borders" class="table-of-contents__link toc-highlight">28.Drawing Borders</a></li><li><a href="#29creating-a-pivot-table" class="table-of-contents__link toc-highlight">29.Creating a Pivot Table</a></li><li><a href="#29--cells-with-multiple-styles-rich-text-strings" class="table-of-contents__link toc-highlight">29.  Cells with multiple styles (Rich Text Strings)</a><ul><li><a href="#hssf-example" class="table-of-contents__link toc-highlight">HSSF Example</a></li><li><a href="#xssf-example" class="table-of-contents__link toc-highlight">XSSF Example</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>